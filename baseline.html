<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="stylesheet" href="css/audit.css" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Duplin County Partnership for Children Web Audit</title>
  </head>

  <body ng-app="audit">
    <div id="container">
      <div class="inner">
        <header>
          <h1>Duplin County Partnership for Children Web Audit</h1>
          <h2>Baseline</h2>
        </header>

        <hr>

        <section id="main_content">
           <a href="index.html">Home</a> |
           <a href="glossary.html">Glossary</a> | 
           Baseline |
           <a href="recommendations.html">Recommendations</a>
            <div ng-controller="baseline">
                <table>
                    <tr>
                        <th></th>
                        <th>Details</th>
                    </tr>
                    <tr ng-repeat="item in baseline.sections | orderBy: 'sort'">
                        <td ng-bind="item.title"></td><td audit-baseline-details="item.details"></td>
                    </tr>
                </table>
            </div>
        <p><ul>
            
        </ul></p>

        </section>

        <footer>
          Duplin County Partnership for Children Web Audit is maintained by <a href="https://github.com/KamiQuasi">Luke Dary</a>
        </footer>

        
      </div>
    </div>
    <script src="js/angular.min.js"></script>
    <script src="js/angular-resource.min.js"></script>
    <script>
        (function() {
            angular.module('audit', ['ngResource'])
                .factory('baselines', ['$resource', function($resource) {
                    return $resource('data/baseline.json', null, {});
                }])
                .directive('auditBaselineDetails', function() {
                    return {
                        scope: { auditBaselineDetails: '=' },
                        link: function(scope, element, attr) {
                            var obj = scope.auditBaselineDetails,
                                upd = '';
                            if(typeof obj === "object") {
                                if(obj.name && obj.url) {
                                    upd = '<a href="'+obj.url+'">'+obj.name+'</a>';
                                } else {
                                    upd = '<ul>';
                                    for(var i=0, len=obj.length; i<len; i++) {
                                        if(obj[i].name && obj[i].url) {
                                            upd += '<li><a href="'+obj[i].url+'">'+obj[i].name+'</a>';
                                            if(obj[i].details) {
                                                upd += ' - '+obj[i].details;
                                            }                                            
                                            upd += '</li>';
                                        } else {
                                            upd += '<li>'+obj[i]+'</li>';
                                        }
                                    }
                                    upd += '</ul>';
                                }
                            } else {
                                upd = obj;
                            }
                            
                            element.html(upd);
                        }
                        
                    };
                })
                .controller('baseline', ['$scope', 'baselines', function($scope, baselines) {
                    $scope.baseline = baselines.get();  
                }]);
        }())
    </script>
  </body>
</html>